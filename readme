CREATE TABLE users (
  lineUserId VARCHAR(255) NOT NULL PRIMARY KEY,
  name VARCHAR(100) NOT NULL,
  ID_card_No VARCHAR(20) NOT NULL,
  Phone_No VARCHAR(20) NOT NULL,
  Email VARCHAR(100) DEFAULT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
  ALTER TABLE users ADD COLUMN verify_status TINYINT DEFAULT 0;
);

CREATE TABLE addresses (
  address_id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  lineUserId VARCHAR(255) DEFAULT NULL,
  house_no VARCHAR(100) DEFAULT NULL,
  Alley VARCHAR(255) DEFAULT NULL,
  province VARCHAR(100) NOT NULL,
  district VARCHAR(100) NOT NULL,
  sub_district VARCHAR(100) NOT NULL,
  postal_code VARCHAR(10) NOT NULL,
  address_verified TINYINT(1) DEFAULT 0,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  FOREIGN KEY (lineUserId) REFERENCES users(lineUserId) ON DELETE CASCADE
);

CREATE TABLE bills (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  address_id INT(11) NOT NULL,
  amount_due DECIMAL(10, 2) NOT NULL,
  due_date DATE NOT NULL,
  created_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  status TINYINT(1) DEFAULT 0,
  FOREIGN KEY (address_id) REFERENCES addresses(address_id) ON DELETE CASCADE
);

mockup data bill ในส่วนของ status หลัง 1 จะแทนว่า ยังไม่ได้ชำระ 0 จะแทนว่า ชำระแล้ว

INSERT INTO bills (address_id, amount_due, due_date, status) VALUES
(1, 1200.50, '2024-04-10', 0),
(2, 850.75, '2024-04-15', 1),


CREATE TABLE admins (
  id INT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY,
  admin_username VARCHAR(255) NOT NULL,
  admin_password VARCHAR(255) NOT NULL
);

-- สร้างตาราง waste_pricing
CREATE TABLE IF NOT EXISTS `waste_pricing` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `type` enum('general','hazardous','recyclable') NOT NULL,
  `price_per_kg` decimal(10,2) NOT NULL,
  `updated_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  PRIMARY KEY (`id`),
  UNIQUE KEY `type` (`type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

-- เติมข้อมูล
INSERT INTO `waste_pricing` (`id`, `type`, `price_per_kg`, `updated_at`) VALUES
(1, 'general', 15.00, '2025-05-27 09:29:20'),
(2, 'hazardous', 20.00, '2025-05-27 09:29:20'),
(3, 'recyclable', -4.00, '2025-05-27 09:29:20');

-- รีเซ็ต AUTO_INCREMENT ให้ ID วิ่งต่อจาก 4 (ไม่ใส่ก็ได้)
ALTER TABLE `waste_pricing` AUTO_INCREMENT = 4;

-- สร้างตารางคอย records จำนวนขยะที่ทิ้งแล้วนำประมวลผลโชว์เป็น pie chart
CREATE TABLE waste_records (
  id INT AUTO_INCREMENT PRIMARY KEY,
  address_id INT NOT NULL,
  waste_type ENUM('general','hazardous','recyclable') NOT NULL,
  weight_kg DECIMAL(10,2) NOT NULL,
  recorded_date DATE NOT NULL DEFAULT CURRENT_DATE,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  FOREIGN KEY (address_id) REFERENCES addresses(address_id) ON DELETE CASCADE
);

--ไว้ค้อยเช็คจำนวนขยะต่อเดือนที่เข้ามา
SELECT DISTINCT DATE_FORMAT(recorded_date, '%Y-%m') AS month
FROM waste_records
ORDER BY month DESC;


ติดตั้งเพื่อให้สามารถแก้ ว/ด/ปี เป็นแบบไทย
npm install react-datepicker date-fns
npm install date-fns@2.30.0

สร้างคอลลัมใหม่เพื่อแสดงว่า Admin คนไหนเป็นคนทำการยืนยันตัวตน ยืนยันครัวเรือน และแก้ไขราคาขยะ
(smartpayt --> SQL --> แล้วก็อปข้างล่างวางเลย)
ALTER TABLE users ADD COLUMN admin_verify INT NULL;
ALTER TABLE addresses ADD COLUMN admin_verify INT NULL;
ALTER TABLE waste_pricing ADD COLUMN admin_verify INT NULL;

ติดตั้งเพื่อ export Excel
npm install file-saver
npm install xlsx

