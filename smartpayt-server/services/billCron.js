const cron = require('node-cron');
const adminController = require('../controllers/adminControllers');
require('dotenv').config();

// üìå CRON ‡∏£‡∏±‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1 ‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ï‡∏≠‡∏ô 14:00 (02:00 PM) Asia/Bangkok
// ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö: ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô ‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
// '0 14 1 * *' ‡∏Ñ‡∏∑‡∏≠: ‡∏ô‡∏≤‡∏ó‡∏µ 0, ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á 14 (‡∏ö‡πà‡∏≤‡∏¢ 2 ‡πÇ‡∏°‡∏á), ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 1, ‡∏ó‡∏∏‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏Ç‡∏≠‡∏á‡∏™‡∏±‡∏õ‡∏î‡∏≤‡∏´‡πå
cron.schedule('0 14 1 * *', () => {
  console.log('‚è≥ [CRON] ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ö‡∏¥‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏à‡∏≥‡πÄ‡∏î‡∏∑‡∏≠‡∏ô');

  adminController.generateBillsFromWasteToday({}, {});
}, { timezone: 'Asia/Bangkok' });

console.log('‚úÖ Bill cron job started. ‡∏£‡∏≠‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏≥‡∏á‡∏≤‡∏ô...');